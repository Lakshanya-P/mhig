<!DOCTYPE html>
<html>
   <head>
       <title> MHIG: New User Screen </title>
       <link rel="stylesheet" href="style.css">
   </head>




   <body id="body_login_2">
       <div id="header"><h2>.</h2></div>
       <div class="form">
           <h2 id="title_h2_2">Please answer the following general questions. </h2>
           <form>
               <div class="spacing">
                   <label id="returninguser_label_2" > Are you a returning patient? If so, click below and skip this page! </label>
               </div>




               <div class="spacing">
                   <button id="returninguser_button_2"> ➡️ </button>
               </div>




               <div class="spacing">
                   <label id="questions_label_2"> Else, fill out these questions: </label>
               </div>




               <div id="questions1_container_2">
                   <label>What's your name? </label>
                   <div class="inputbox">
                           <input type="text" value="" id="name" >
                   </div>       
               </div>




               <div id="questions2_container_2">
                   <label>What's your age?</label>
                   <div class="inputbox">
                       <input type="number" value="" id="age" >
                   </div>
               </div>
             
               <div class="spacing">
                   <button type="submit" value="submit" class="sub" id="submit_button_2">Submit</button>
               </div>
           </form>
           <div class="spacing">
               <button id="getlogin_button_2" onclick="getlogin()" > Get Login ID </button>
           </div>
       </div>
       <div id="footer"><h2>.</h2></div>




       <script type="module">
         
           document.getElementById("returninguser_button_2").addEventListener("click",next);
         
           function next(e) {
               e.preventDefault();
               window.location.replace("login.html")
           }




           document.getElementById("getlogin_button_2").addEventListener("click", getlogin);




           function getlogin() {
               window.location.replace("new_user_ID.html");
           }




         




           // Import the functions you need from the SDKs you need
           import { initializeApp } from "https://www.gstatic.com/firebasejs/10.9.0/firebase-app.js";
           import { getDatabase, ref, set, get, child } from "https://www.gstatic.com/firebasejs/10.9.0/firebase-database.js";




           // Your web app's Firebase configuration
           const firebaseConfig = {
               apiKey: "AIzaSyCEjbKjo7bLbXsLm2FFS3nb5TjXNXMg2lc",
               authDomain: "mhig-edde5.firebaseapp.com",
               projectId: "mhig-edde5",
               storageBucket: "mhig-edde5.appspot.com",
               messagingSenderId: "855050639590",
               appId: "1:855050639590:web:84c985fb7c8e066681c327"
           };

           // Initialize Firebase
           const app = initializeApp(firebaseConfig);

           // get ref to database services
           const mhig = getDatabase(app);


           function generateUserID() {
               return Math.floor(Math.random() * 1000000); // Change this to a more secure method for production
           }

           const userID = generateUserID();

           document.getElementById("submit_button_2").addEventListener('click', function(e){
               e.preventDefault();
               set(ref(mhig, 'user/' + userID),
               {

                   patient_name: document.getElementById("name").value,
                   patient_age: document.getElementById("age").value,
                   

               });
               localStorage.setItem("userID", userID);
               alert("Sign up successful!")




                 
           });




       </script>




   </body>
</html>



